"use strict";var jwt=require("jsonwebtoken");require("dotenv").config(),exports.auth=function(s,e,t){try{var n=s.body.token;if(!n)return e.status(401).json({success:!1,message:"token missing"});try{var o=jwt.verify(n,process.env.JWT_SECRET);console.log(o),s.user=o}catch(s){return e.status(401).json({success:!1,message:"token is invalid"})}t()}catch(s){return console.log(s),e.status(401).json({success:!1,message:"Something went wrong while verifying token"})}},exports.isStudent=function(s,e,t){try{if("Student"!==s.user.role)return e.status(401).json({success:!1,message:"This is a protect route for students you can not access it"});t()}catch(s){return e.status(500).json({success:!1,message:"User Role is not Matching"})}},exports.isAdmin=function(s,e,t){try{if("Admin"!==s.user.role)return e.status(401).json({success:!1,message:"This is a protect route for Admins,you can not access it"});t()}catch(s){return e.status(500).json({success:!1,message:"User Role is not Matching"})}};
//# sourceMappingURL=auth.min.js.map
